#include <stdio.h>

int S[256] = {11, 77, 127, 182, 190, 244, 172, 1, 154, 236, 24, 208, 178, 45, 23, 31, 
66, 167, 120, 112, 15, 173, 108, 52, 145, 21, 137, 65, 114, 42, 195, 233, 
189, 75, 202, 46, 96, 124, 67, 247, 105, 255, 144, 168, 43, 136, 79, 74, 
176, 71, 98, 44, 198, 234, 3, 226, 37, 212, 201, 148, 22, 221, 175, 170, 
40, 143, 220, 4, 27, 251, 48, 88, 8, 84, 254, 17, 113, 171, 158, 147, 
229, 30, 111, 238, 180, 139, 150, 225, 56, 47, 60, 237, 155, 248, 99, 82, 
160, 240, 86, 217, 187, 192, 245, 142, 6, 25, 159, 104, 132, 241, 39, 227, 
162, 123, 130, 141, 128, 50, 211, 213, 183, 203, 125, 214, 249, 188, 57, 121, 
224, 184, 91, 194, 14, 54, 107, 81, 101, 232, 51, 10, 0, 109, 235, 97, 
36, 90, 19, 210, 199, 169, 92, 165, 2, 185, 117, 64, 106, 80, 13, 118, 
166, 102, 164, 59, 219, 200, 152, 246, 26, 131, 89, 252, 186, 140, 83, 34, 
5, 222, 206, 49, 63, 209, 239, 94, 68, 253, 231, 205, 87, 215, 85, 76, 
135, 29, 72, 12, 149, 163, 138, 28, 193, 161, 218, 119, 35, 179, 133, 122, 
38, 115, 153, 191, 41, 129, 216, 73, 32, 9, 134, 55, 93, 100, 69, 207, 
78, 62, 110, 53, 250, 7, 16, 151, 157, 197, 70, 230, 126, 20, 58, 196, 
33, 95, 116, 174, 61, 177, 228, 204, 146, 223, 18, 156, 103, 243, 242, 181
};


int t,k=1,i=0,j=0;
//
// Modified RC4-Algorithm from Ron Rivest
// Generate 1000 x 8 random bits from SBOX
// 
int next(){
    static int S[256],i,j,k;
    static int init = 1;
    if (init){
      for (k=0;k<256;k++) S[k] = k;
      i = j = k = 0;
      init = 0;
    }
    i = (i + 1) % 256;
    j = (S[(S[i] + j) % 256] + k) % 256;
    k = (k + S[(i + j) % 256]) % 256;
    t = S[k] + S[j];
    S[k] = t - S[k];
    S[j] = t - S[j];
    return S[S[(t+j + S[i]*S[j]) % 256]];
}
int next_1(){
    static int S[256],i,j,k;
    static int init = 1;
    if (init){
      for (k=0;k<256;k++) S[k] = k;
      i = j = k = 0;
      init = 0;
    }
    i = (i + 1) % 256;
    j = (S[(S[i] + j) % 256] + k) % 256;
    k = (k + S[(i + j) % 256]) % 256;
    t = S[i];
    S[i] = S[j];
    S[j] = S[k];
    S[k] = t;
    return S[S[(t+j + S[i]*S[j]) % 256]];
}
int next_0(){
    i = (i + 1) % 256;
    j = (S[i] + j) % 256;
    t = S[i] + S[j];
    S[i] = t - S[i];
    S[j] = t - S[j];
    return S[S[t % 256]];
}

int main(){
  int sum = 0;
  for (int ii=0; ii<1000; ii++){
     printf("%d ", next_0());
     if (ii % 20 == 19) printf("\n");
  }
  for (int ii=0;ii<256;ii++) sum += S[ii];
  fprintf(stderr,"0 = %d\n",sum - 128*255);
}